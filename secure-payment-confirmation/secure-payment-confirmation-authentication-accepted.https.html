<!DOCTYPE html>
<meta charset="utf-8">
<title>Reproduction of WebAuthn failure on WPT CI</title>
<link rel="help" href="https://w3c.github.io/secure-payment-confirmation#sctn-authentication">
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="/resources/testdriver.js"></script>
<script src="/resources/testdriver-vendor.js"></script>
<script src="utils.sub.js"></script>
<script>
'use strict';

promise_test(async t => {
  console.log('Adding authenticator');
  const authenticator = await window.test_driver.add_virtual_authenticator(
      AUTHENTICATOR_OPTS);
  console.log('Authenticator:', authenticator);
  t.add_cleanup(() => {
    console.log('Clean-up: Removing authenticator');
    return window.test_driver.remove_virtual_authenticator(authenticator);
  });

  console.log('Creating credential');
  const credential = await createCredential();
  console.log('Created credential');
}, 'Testing if SPC is involved');
</script>
