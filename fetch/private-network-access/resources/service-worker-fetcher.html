<!DOCTYPE html>
<meta charset="utf-8">
<title>ServiceWorker Fetcher</title>
<script>
  window.addEventListener("message", async (evt) => {
    let { url, uuid } = evt.data;

    try {
      const registration = await navigator.serviceWorker.register(url, {
        scope: `./${uuid}`,
      });
      const unregistered = await registration.unregister();
      parent.postMessage({ loaded: true, unregistered }, "*");
    } catch (e) {
      parent.postMessage({ loaded: false, error: e.name }, "*");
    }
  });
</script>

