<!DOCTYPE html>
<script nonce="abc" src="/resources/testharness.js"></script>
<script nonce="abc" src="/resources/testharnessreport.js"></script>
<script nonce="abc" src="/preload/resources/preload_helper.js"></script>
<script nonce="abc">
promise_test(async t => {
    await new Promise(async (resolve, reject) => {
        if (!isPreloadAndRTSupported()) {
            reject("Unsupported APIs");
        }
        await untilResourceDownloaded("resources/dummy.js?with-nonce");
        verifyNumberOfDownloads("resources/dummy.js?without-nonce", 0);
        verifyNumberOfDownloads("resources/dummy.js?with-nonce", 1);
        resolve();
    });
}, 'Makes sure that Link headers preload resources with CSP nonce');
</script>
