<!DOCTYPE html>
<meta charset="utf-8">
<title>Rendering layers across frames</title>
<body>
<script>

const canvas = document.createElement("canvas");
canvas.width = 200;
canvas.height = 200;
document.body.appendChild(canvas);

const ctx = canvas.getContext("2d");
ctx.fillStyle = '#00F';
ctx.fillRect(60,60,75,50);

function secondFrame(){
  ctx.fillStyle = '#0F0';
  ctx.fillRect(70,70,75,50);
  ctx.restore();
  ctx.fillRect(80,80,75,50);
}

function firstframe(){
  ctx.save();
  ctx.globalAlpha = 0.5;
  ctx.fillStyle = '#F00';
  ctx.fillRect(50,50,75,50);
  requestAnimationFrame(secondFrame);
}

requestAnimationFrame(firstframe);

ctx.fillRect(100,100,75,50);

</script>
</body>
