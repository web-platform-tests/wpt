<!DOCTYPE html>
<script src="/common/get-host-info.sub.js"></script>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="/resources/testdriver.js"></script>
<script src="/resources/testdriver-vendor.js"></script>

<body>
<!-- If first iframe is removed, 2nd iframe starts being able to request transient activation -->
<iframe></iframe><br/>
<iframe id="test_iframe"></iframe><br/>

<script type="module">
export function loadIframe(iframe, url) {
  return new Promise((resolve, reject) => {
    iframe.addEventListener("load", resolve, { once: true });
    iframe.addEventListener("error", reject, { once: true });
    iframe.src = url;
  });
}

promise_test(async t=>{
  const test_iframe = document.getElementById("test_iframe");
  const hostInfo = get_host_info();
  await loadIframe(
     test_iframe,
    `${hostInfo.HTTPS_REMOTE_ORIGIN}/digital-credentials/support/iframe2.html`
  );

  test_iframe.contentWindow.postMessage("gain_user_activation", "*");
  await new Promise((resolve)=>{});
}, "iframe should get user activation");

</script>
