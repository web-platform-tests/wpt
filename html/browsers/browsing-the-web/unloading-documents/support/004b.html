<!DOCTYPE HTML>
<script>
    function testRun(w) {
      console.log("w", w);
   localStorage.test6564729 += 'H';
   var d = parent.document;
    console.log("before open");
   var e = parent.document.open(); // no effect, since that document is already in unload
    console.log("after open");
   localStorage.test6564729 += (e == d) ? 'I' : 'X';
   var s = 'FAIL';
   document.write(s);
   localStorage.test6564729 += document.body.textContent == s ? 'x' : 'J';
    console.log("before close");
   document.close();
    console.log("after close");
   localStorage.test6564729 += 'K';
 }
</script>
<body onbeforeunload="localStorage.test6564729 += 'D'"
      onpagehide="localStorage.test6564729 += 'G'"
      onunload="testRun('onunload')">
<p>Inner frame
